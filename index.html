<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Firebase Google Login Test</title>
</head>
<body>
  <button id="google-login">Googleでログイン</button>
  <div id="status">ログイン状態: 未ログイン</div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithRedirect, onAuthStateChanged, setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

    // --- Firebase 設定 ---
    const firebaseConfig = {
      apiKey: "AIzaSyDwZQfWkf_h-Dc219uJpTtJNJElZ5l-0Ok",
      authDomain: "score-junken-online.firebaseapp.com",
      projectId: "score-junken-online",
      storageBucket: "score-junken-online.firebasestorage.app",
      messagingSenderId: "656405933288",
      appId: "1:656405933288:web:122a765c95d61b0a0ded5d",
      measurementId: "G-5SDM8HE1N1"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const provider = new GoogleAuthProvider();

    // 永続化を設定（認証開始前）
    await setPersistence(auth, browserLocalPersistence);

    document.getElementById("google-login").addEventListener("click", () => {
      signInWithRedirect(auth, provider);
    });

    // ログイン状態監視
    onAuthStateChanged(auth, user => {
      const statusEl = document.getElementById("status");
      if (user) {
        console.log("ログイン中:", user.uid, user.displayName);
        statusEl.textContent = `ログイン状態: ${user.displayName}（UID: ${user.uid}）`;
      } else {
        console.log("未ログイン");
        statusEl.textContent = "ログイン状態: 未ログイン";
      }
    });
  </script>
</body>
</html>